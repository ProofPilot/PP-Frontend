{% block scripts_facebook %}
        <script type="text/javascript">
            function fb_login() {
                FB.getLoginStatus(function(response) {
                    if (response.status === 'connected') {
                        // connected
                    	if ($("#recruiter").length > 0 || $("#recruiter_loggedin").length > 0){
                    		if ($("#recruiter").length > 0) {
                            	if ($('#recruiter').is(':checked')){
                            	    var recruiter =  1 ;
                            	} else {
                            		var recruiter =  0 ;
                                }
                            }
                    		if ($("#recruiter_loggedin").length > 0){
                            	if ($('#recruiter').is(':checked')){
                            	    var recruiter =  1 ;
                            	} else {
                            		var recruiter =  0 ;
                                }
                        	}
                    		if (typeof recruiter !== 'undefined') {
                    		    var path = '/{{ app.request.get('_locale') }}/doOauth/{{ studyCode }}/'+recruiter;
                    		    
                        	} else {
                        		var path = '{{ path("_do_oauth", {'studyCode' : studyCode}) }}';
                            }   
                    		var url = '{{ url("frontend_oauth_service_redirect", {
                                service: "facebook", 
                                studyCode: studyCode, 
                                _destination: 'path'
                                }) | raw
                            }}'
                            url = url.replace("isRecruiter", recruiter );
                            url = url.replace("path", path );
                            document.location = url;
                    	} else {
                            document.location = "{{ url("frontend_oauth_service_redirect", {
                                service: "facebook", 
                                studyCode: studyCode, 
                                _destination: path("_do_oauth", {'studyCode' : studyCode}) 
                                }) | raw
                            }}";
                    	}
                    } else {
                        // not_authorized
                        FB.login(
                                function(response) {
                                    if (response.authResponse) {

                                            document.location = "{{ url("frontend_oauth_service_redirect", {
                                                    service: "facebook", 
                                                    studyCode: studyCode, 
                                                    _destination: path("_do_oauth", {'studyCode' : studyCode}) 
                                                    }) | raw
                                                }}";
                                    }
                                },
                                {scope: 'email, user_hometown, user_location'} 
                        );
                    }
                });
            }

            function fbLogout() {
          	  FB.getLoginStatus(function(response) {
          		  if (response.status === 'connected') {
          		    var uid = response.authResponse.userID;
          		    var accessToken = response.authResponse.accessToken;
          		    FB.logout(function (response) {
          		    });
          		  } 
          		 });
            }


            function postFeed(link, title,description, image, name ){

                    FB.ui({method: 'feed',
                picture: image ,
                name: name,
                link: link,
                caption: title,
                description: description,
                    },function(response) {
                        self.close();
                    });
                return false;
            }
        
            window.fbAsyncInit = function() {
                FB.init({
                    "appId":"{{ facebook_appid }}",
                    "xfbml":true,
                    "oauth":true,
                    "status":true,
                    "cookie":true,
                    "logging":true});
            };
            
            // Load the SDK asynchronously
            (function(d, s, id){
               var js, fjs = d.getElementsByTagName(s)[0];
               if (d.getElementById(id)) {return;}
               js = d.createElement(s); js.id = id;
               js.src = "//connect.facebook.net/en_US/all.js";
               fjs.parentNode.insertBefore(js, fjs);
             }(document, 'script', 'facebook-jssdk'));
        </script>
{% endblock  scripts_facebook %}