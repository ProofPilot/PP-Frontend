{% extends '::base.html.twig' %}

{% block javascripts %}

<script type="text/javascript">
        function goLogIn(){
            window.location = "{{ path('_fb_security_check') }}";
        }

        function onFbInit() {
            if (typeof(FB) != 'undefined' && FB != null ) {
                FB.Event.subscribe('auth.statusChange', function(response) {
                    setTimeout(goLogIn, 500);
                });
            }
            FB.Event.subscribe('auth.logout',
                     function(response) {
                         if (response.status === 'unknown')  {
                            window.location = "{{ path('_logout') }}";
                          }
            });                            
        }
        
        $(document).ready(function(){
            $('#login_submit').click(function()
                {
                        $('#submit_button').trigger('click');
                        return false;
                });

            $('#facebook_button').click(function()
                 { 
                         FB.login(null, {scope: "email"});
                 });
           });
</script> 

{% endblock javascripts %}

{% block body %}
    <body class="has_image">
		{{ facebook_initialize({'async': true, 'xfbml': true, 'fbAsyncInit': 'onFbInit();'}) }}
		<div class="reg_header">
			<a href="http://proofpilot.com/" class="logo">ProofPilot</a>
		</div>
		
		<div class="mobile_reg login_form">
			
			<div class="wrapper">
			
				<h1>{% trans from "login" %}txt_log_in{% endtrans %}</h1>
				
				<div class="loginform_left">
				
					<div class="btns_wapper">
						<form>
						{{ facebook_login_button({'autologoutlink': true}, 'CyclogramFrontendBundle:Facebook:loginButton.html.twig') }}
{# 							<a class="btn_reg fb" href="#"><span>Login with Facebook</span></a>#}
						</form>
						<form>
							<a id="expand_google_form" class="btn_reg google" href="#"><span>Login with Google</span></a>
						</form>	
					</div>
					<div class="notice2"><p><span>{% trans from "login" %}txt_login_securely{% endtrans %}</span></p></div>
				
				</div>
				
				<div class="sep">
					{% trans from "login" %}txt_or{% endtrans %}
				</div>
				
				<div class="loginform_right">
					<form action="{{ path('login_check') }}" method="post">
					    <a class="forgot" href="{{ path('_forgot_username') }}">{% trans from "login" %}txt_forgot_your_username{% endtrans %}</a>
						<label for="reg_field_1">{% trans from "login" %}txt_form_username{% endtrans %}</label>
						<span class="input_placeholder "><input type="text" class="text " value="{{ last_username }}" id="reg_field_1" name="_username" ><span class="mark"></span></span>
						<label for="reg_field_2">{% trans from "login" %}txt_form_password{% endtrans %}</label><a class="forgot" href="{{ path('_forgot_pass') }}">{% trans from "login" %}txt_forgot_your_password{% endtrans %}</a>
						<span class="input_placeholder"><input type="password" class="text" name="_password" id="reg_field_2"><span class="mark"></span></span>
						{% if error %}<div><p class="error">{%  trans from "login" %}txt_login_error_message{% endtrans %}</p></div>{% endif %}
						<div class="actions_row">
							<input type="checkbox" value="" class="checkbox" name="">{%  trans from "login" %}txt_stay_logged_in{% endtrans %}
							<a id="login_submit" class="submit btn_login" href="#">{% trans from "login" %}txt_login_button{% endtrans %}</a>
							<button type="submit" style="display:none" id="submit_button"></button>
						</div>
						
					</form>
				</div>			
			
			</div>

		</div>
    </body>
{% endblock body %}
