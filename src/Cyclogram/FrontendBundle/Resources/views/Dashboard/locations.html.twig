<style type="text/css">
  #map { height: 100% }
</style>
<div class="mobile_reg login_form ontop wide_popup with_map">
    <div class="wrapper">
        <div class="popup_header">
            <h1>LOCATIONS</h1>
            <span>near New York, NY</span>
        </div>
        <div class="popup_sidebar">
            <div class="maps_search">
                <form>
                    <p class="input_note">Input your locations to search</p>
                    <input type="text" name="" placeholder="Zip code or city & state, etc." class="text"/>
                    <a href="#" class="submit_form">SEARCH</a>
                </form>
            </div>
            <div class="mobile_switcher">
                <a href="#" class="contacts active">CONTACTS</a>
                <a href="#" class="map">MAP</a> 
            </div>
            <div class="results">
                <ul>
                    {% for organization in organizations %}
                    <li>
                        <div class="text_wrapper">
                            <div class="text_left">
                                <h2><a href="" class="location_details">{{ organization.organizationName }}</a></h2>
                                <p>{{ organization.organizationAddress1 }}<br>{{ organization.organizationAddress2 }}</p>
                            </div>
                            <div class="text_right">
                                <a href="#">Select</a>
                            </div>   
                            <div class="info_box" style="display: none;">
                                <div class="box_bg">
                                    <div class="text_cont">
                                        <a href="#" class="close"></a>
                                        <h1>{{ organization.organizationName }}</h1>
                                        <p>{{ organization.organizationAddress1 }}<br>{{ organization.organizationAddress2 }}</p>
                                        <hr/>
                                        <div class="wrapper">
                                            <p><strong>Organization Type:</strong><br/>Clinic</p>
                                            <p><strong>On the Web:</strong><br /><a href="#">www.cbwchc.org</a></p>
                                            <p><strong>Hours of Operation:</strong><br />Mon, Tues, Thurs, Wed, 9:30am-7pm; Sat, Sun, 8:30am-6pm.</p>
                                            <p>
                                                <strong>Services:</strong><br />
                                                - Maecenas in mi vitae ligula suscipit hendrerit nec et eros.<br />
                                                - Donec luctus quam at ipsum malesuada sodales.<br />
                                                - Sed pulvinar enim non iaculis tempor.<br />
                                                - Sed pulvinar enim non iaculis tempor.<br />
                                                - Sed pulvinar enim non iaculis tempor.<br />
                                                - Sed pulvinar enim non iaculis tempor.<br />
                                                - Aenean at felis nec ligula congue pharetra.
                                            </p>
                                        </div>                            
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="popup_map" id="map"></div>
    </div>
</div>        
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAgFoz3VYlZpWVsuIKfplU6c0yr8VaaoMc&sensor=false"></script>
<script type="text/javascript">
    $(document).ready(function(){
        
        var map;
        var markers = [];
        var infoWindow;
        var locationSelect;
            
        function load() {
            map = new google.maps.Map(document.getElementById("map"), {
              center: new google.maps.LatLng(40, -100),
              zoom: 4,
              mapTypeId: 'roadmap',
              mapTypeControlOptions: {style: google.maps.MapTypeControlStyle.DROPDOWN_MENU}
            });
//            infoWindow = new google.maps.InfoWindow();

//            locationSelect = document.getElementById("locationSelect");
//            locationSelect.onchange = function() {
//              var markerNum = locationSelect.options[locationSelect.selectedIndex].value;
//              if (markerNum != "none"){
//                google.maps.event.trigger(markers[markerNum], 'click');
//              }
//            };
         }
              
//        $('.location_details').bind('click', function(e){
//        	e.preventDefault();
//        	var info = $(this).parents('.text_left').siblings('.info_box');
//        	if(!info.is(":visible")) {
//        		$(this).parents('.text_left').siblings('.info_box').show();
//        		$(this).closest('li').siblings().find('.info_box').hide();
//            } else {
//            	$(this).parents('.text_left').siblings('.info_box').hide();
//            }
//        });
        $('.location_details').bind('click', function(e){
        	e.preventDefault();
            $.ajax({
                dataType: "json",
                type: "POST",
                url: "{{ path('searchOrganizationLocations')}}",
                data: {organization : $(this).html()}
            })
                .done (function(response) {
                    if(response.success) {
                    	$('#currency_symbol').html(response.currencySymbol);
                    }
                });
        });
        
        $('.text_wrapper .info_box').bind('click', '.close', function(e) {
        	e.preventDefault();
            $('.info_box').hide();
        });
        $('.text_right a').bind('click', function(e) {
        	e.preventDefault();
            $(this).toggleClass('select_btn');
        });
        $('.mobile_switcher a').bind('click', function(e) {
        	e.preventDefault();
        	if($(this).hasClass('contacts')) {
        		$('.results').show();
                $('.popup_map').hide();
            } else {
                $('.results').hide();
                $('.popup_map').show();
            }
            $(this).addClass('active');
            $(this).siblings().removeClass('active');
        });
        load();
    });

</script>